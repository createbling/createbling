<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.createbling.modules.sys.dao.AreaDao">

<!-- 查询某个节点名返回的结果集的定义 -->
<resultMap id="node_id_name" type="com.createbling.modules.sys.entity.Area">
	<id column="id" property="id" />
    <result column="name" property="name" />
</resultMap>

<!--根据id修改非参数和周期节点的名称-->
<update id="updateNodeName" >
		update sys_tree set name=#{name} where id=#{id}
</update>

<!-- 修改参数或者周期节点的名称，先把历史节点的flag置为-1，即不可见 。之后还要进行新节点的插入操作-->
<update id="updateNodeNameWithHistory" >
		update sys_tree set flag=-1 where id=#{id}
</update>

<!-- 查找所有的基地名字 -->
<select id="findNodeBase" resultType="node_id_name">
		SELECT id,name FROM sys_tree WHERE parent_id=null
</select>

<!-- 按照父节点查找其所有子节点 -->
<select id="findNodeByParent" resultType="node_id_name">
		SELECT id,name FROM sys_tree WHERE parent_ids like "%,#{parent_id}%"
</select>

<!-- 按照id查询某个节点的所有信息 -->
<select id="findNodeById" resultType="com.createbling.modules.sys.entity.Area">
		SELECT id,name,parent_id,parent_ids,children_ids,description,flag,type,sort
					create_by,create_date,update_by,update_date
		 FROM sys_tree WHERE id=#{id}
</select>

</mapper>